<h1>Benvenuto, <strong><%= user.username %></strong></h1>

<p>
	Squadra:
	<% if (typeof squads !== 'undefined' && squads && squads.length > 0) { %>
		<strong><%= squads[0].nome %></strong>
		<% if (squads[0].coOwnerName) { %>
			in comproprietà con <strong><%= squads[0].coOwnerName %></strong>
		<% } %>
	<% } else { %>
		Nessuna squadra
	<% } %>
</p>

<% if (typeof players !== 'undefined' && players && players.length > 0) { %>
	<h2>Giocatori</h2>
	<table class="table">
		<thead>
			<tr>
				<th>Giocatore</th>
				<th>Contratto</th>
				<th>Tesseramento</th>
				<th>Stipendio</th>
			</tr>
		</thead>
		<tbody>
			<% players.forEach(function(p) { %>
				<tr>
					<td><%= p.nome %></td>
					<td>
						<% if (p.contratto && p.contratto.date) { %>
							<%= p.contratto.date %>
							<% if (p.contratto.otherTeamName) { %>
								(<%= p.contratto.otherTeamName %>)
							<% } %>
						<% } else { %>
							-
						<% } %>
					</td>
					<td>
						<% if (p.tesseramento && p.tesseramento.date) { %>
							<%= p.tesseramento.date %>
							<% if (p.tesseramento.otherTeamName) { %>
								(<%= p.tesseramento.otherTeamName %>)
							<% } %>
						<% } else { %>
							-
						<% } %>
					</td>
					<td>
						<% if (p.thisAmount !== null) { %>
							€<%= p.thisAmount.toFixed(2) %>
							<% if (p.othersAmount && p.othersAmount > 0) { %>
								(€<%= p.othersAmount.toFixed(2) %>)
							<% } %>
						<% } else { %>
							-
						<% } %>
					</td>
				</tr>
			<% }); %>
		</tbody>
	</table>
<% } %>

<% if (typeof error !== 'undefined' && error) { %>
	<p class="form-error"><%= error %></p>
<% } %>

<!-- Cambia password button -->
<button id="open-change-password" class="btn" type="button">Cambia password</button>

<!-- Change password modal -->
<div id="change-password-modal" class="modal hidden">
	<div class="modal-content">
		<h2>Cambia password</h2>
		<form id="change-password-form" class="auth-form" method="POST" action="/cambio-password">
			<label>
				<span class="label">Password attuale</span>
				<input id="oldPassword" name="oldPassword" type="password" required />
			</label>

			<label>
				<span class="label">Nuova password</span>
				<input id="newPassword" name="newPassword" type="password" required />
			</label>

			<label>
				<span class="label">Conferma nuova password</span>
				<input id="confirmNewPassword" name="confirmNewPassword" type="password" required />
			</label>

			<p id="cp-error" class="form-error" style="display:none;"></p>

			<div class="form-actions">
				<button class="btn primary" type="submit">Cambia</button>
				<button id="cp-cancel" class="btn" type="button">Annulla</button>
			</div>
		</form>
	</div>
</div>

<!-- Client script for modal and simple validation -->
<script src="/js/cambiaPassword.js"></script>
